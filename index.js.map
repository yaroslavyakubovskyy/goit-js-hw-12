{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\n\nconst createGalleryCardTemplate = ({\n  largeImageURL,\n  webformatURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) => {\n  return `\n    <div class=\"gallery-wrapper\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\">\n        <ul class=\"gallery-info-list\">\n          <li class=\"gallery-info-item\">\n            <p class=\"gallery-info-title\">Likes</p>\n            <p class=\"gallery-info-value\">${likes}</p>\n          </li>\n          <li class=\"gallery-info-item\">\n            <p class=\"gallery-info-title\">Views</p>\n            <p class=\"gallery-info-value\">${views}</p>\n          </li>\n          <li class=\"gallery-info-item\">\n            <p class=\"gallery-info-title\">Comments</p>\n            <p class=\"gallery-info-value\">${comments}</p>\n          </li>\n          <li class=\"gallery-info-item\">\n            <p class=\"gallery-info-title\">Downloads</p>\n            <p class=\"gallery-info-value\">${downloads}</p>\n          </li>\n        </ul>\n        </a>\n      </div>\n    `;\n};\n\nexport const galleryCardsTemplate = items =>\n  items.map(item => createGalleryCardTemplate(item)).join('');\n\nexport const createLightBox = function () {\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionDelay: 250,\n    captionsData: 'alt',\n  });\n  lightbox.refresh();\n};\n","import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport const fetchPhotosByQuery = (q, currentPage) => {\n  const searchParams = {\n    q,\n    currentPage,\n    key: '49370474-a1716903616cca1a00d36cfab',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n  };\n\n  return axios.get(`/api/`, { params: searchParams });\n};\n","import iziToast from 'izitoast';\n\nimport { galleryCardsTemplate, createLightBox } from './js/render-functions';\nimport { fetchPhotosByQuery } from './js/pixabay-api';\n\nconst refs = {\n  searchForm: document.querySelector('.form'),\n  gallery: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.loader'),\n  btnLoadMore: document.querySelector('.btn-load-more'),\n};\n\nconst itemsPerPage = 15;\nlet totalPages;\nlet currentPage;\nlet q;\n\nrefs.loader.style.display = 'none';\n\nfunction showLoader() {\n  refs.loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  refs.loader.style.display = 'none';\n}\n\nconst onSearchFormSubmit = async event => {\n  try {\n    event.preventDefault();\n\n    currentPage = 1;\n    refs.gallery.innerHTML = '';\n    showLoader();\n\n    q = event.currentTarget.elements.search_text.value.trim();\n\n    if (q === '') {\n      iziToast.error;\n      iziToast.error({\n        title: 'Error',\n        message: `Input cannot be empty!`,\n        position: 'topRight',\n      });\n\n      hideLoader();\n      refs.btnLoadMore.classList.remove('is-visible');\n      event.currentTarget.elements.search_text.value = '';\n\n      return;\n    }\n\n    const {\n      data: { hits: images },\n    } = await fetchPhotosByQuery(q, currentPage);\n\n    if (images.length === 0) {\n      iziToast.error({\n        title: 'Error',\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        position: 'topRight',\n      });\n\n      refs.searchForm.reset();\n      refs.btnLoadMore.classList.remove('is-visible');\n      hideLoader();\n\n      return;\n    }\n\n    refs.gallery.innerHTML = galleryCardsTemplate(images);\n    createLightBox();\n    hideLoader();\n    currentPage += 1;\n\n    refs.btnLoadMore.classList.add('is-visible');\n\n    const elemHeight = document\n      .querySelector('.gallery-wrapper')\n      .getBoundingClientRect().height;\n\n    window.scrollBy({\n      top: elemHeight * 2, // Scroll down by 2 times the element height\n      left: 0,\n      behavior: 'smooth', // Smooth scrolling\n    });\n  } catch (error) {\n    iziToast.error({ title: 'Error', message: error.message });\n    hideLoader();\n  }\n};\n\nrefs.searchForm.addEventListener('submit', onSearchFormSubmit);\n\nrefs.btnLoadMore.addEventListener('click', async () => {\n  try {\n    const {\n      data: { totalHits, hits: images },\n    } = await fetchPhotosByQuery(q, currentPage);\n\n    hideLoader();\n    refs.gallery.insertAdjacentHTML('beforeend', galleryCardsTemplate(images));\n    createLightBox();\n\n    totalPages = Math.ceil(totalHits / itemsPerPage);\n\n    if (currentPage === totalPages) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n\n      refs.btnLoadMore.classList.remove('is-visible');\n      return;\n    }\n\n    currentPage += 1;\n    refs.btnLoadMore.classList.add('is-visible');\n  } catch (error) {\n    iziToast.error({\n      message: error.message,\n      position: 'topRight',\n    });\n\n    console.log(error.message);\n  }\n});\n"],"names":["createGalleryCardTemplate","largeImageURL","webformatURL","tags","likes","views","comments","downloads","galleryCardsTemplate","items","item","createLightBox","SimpleLightbox","axios","fetchPhotosByQuery","q","currentPage","searchParams","refs","itemsPerPage","totalPages","showLoader","hideLoader","onSearchFormSubmit","event","iziToast","images","elemHeight","error","totalHits"],"mappings":"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"}